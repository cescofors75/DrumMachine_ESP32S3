<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>RED808 â€” Patchbay</title>
<link rel="stylesheet" href="patchbay.css">
</head>
<body>
<div id="patchbay">
  <!-- Header -->
  <header id="pbHeader">
    <button class="pb-hdr-btn" onclick="goBack()" title="Volver">âœ•</button>
    <h1>RED808 <span>PATCHBAY</span></h1>
    <button class="pb-hdr-btn" id="pbMenuBtn" onclick="togglePBMenu()" title="MenÃº">â‹¯</button>
    <div id="pbMenu" class="pb-menu hidden">
      <button onclick="pbClearAll()">ğŸ—‘ Borrar todo</button>
      <button onclick="pbResetLayout()">ğŸ“ Reset layout</button>
      <button onclick="pbAutoRoute()">âš¡ Auto-route</button>
      <button onclick="pbBuildChain()">ğŸ§¬ Encadenar FX</button>
      <button onclick="pbOrganizeNodes()">ğŸ§­ Organizar nodos</button>
      <button onclick="pbToggleSignalDemo()">ğŸ¬ Demo seÃ±al</button>
      <button id="pbHeatToggleBtn" onclick="pbToggleHeatMode()">ğŸŒ¡ Heat ON</button>
      <button onclick="pbSaveSnapshot('A')">ğŸ“¸ Guardar Snap A</button>
      <button onclick="pbLoadSnapshot('A')">ğŸ¯ Cargar Snap A</button>
      <button onclick="pbSaveSnapshot('B')">ğŸ“¸ Guardar Snap B</button>
      <button onclick="pbLoadSnapshot('B')">ğŸ¯ Cargar Snap B</button>
      <button id="pbQuantizeBtn" onclick="pbToggleSceneQuantize()">â± Quantize ON</button>
      <button onclick="pbOpenPresetPanel()">ğŸ§© Presets</button>
      <button onclick="pbSavePreset()">ğŸ’¾ Guardar preset</button>
      <button onclick="pbLoadPreset()">ğŸ“‚ Cargar preset</button>
    </div>
  </header>

  <!-- Toolbar -->
  <div id="pbToolbar">
    <div class="pb-brand">
      <span class="pb-logo"><b>R</b><b>E</b><b>D</b><em>8</em><em>0</em><em>8</em></span>
      <span class="pb-subtitle">SIGNAL PATCH</span>
    </div>
    <div class="pb-fx-buttons">
      <button class="pb-add-btn" data-fx="lowpass" onclick="pbAddEffect('lowpass')">+ LOW PASS</button>
      <button class="pb-add-btn" data-fx="highpass" onclick="pbAddEffect('highpass')">+ HI PASS</button>
      <button class="pb-add-btn" data-fx="bandpass" onclick="pbAddEffect('bandpass')">+ BAND PASS</button>
      <button class="pb-add-btn" data-fx="echo" onclick="pbAddEffect('echo')">+ REVERB</button>
      <button class="pb-add-btn" data-fx="delay" onclick="pbAddEffect('delay')">+ DELAY</button>
      <button class="pb-add-btn" data-fx="bitcrusher" onclick="pbAddEffect('bitcrusher')">+ BITCRUSHER</button>
      <button class="pb-add-btn" data-fx="distortion" onclick="pbAddEffect('distortion')">+ DISTORTION</button>
      <button class="pb-add-btn" data-fx="compressor" onclick="pbAddEffect('compressor')">+ COMPRESSOR</button>
      <button class="pb-add-btn" data-fx="flanger" onclick="pbAddEffect('flanger')">+ FLANGER</button>
      <button class="pb-add-btn" data-fx="phaser" onclick="pbAddEffect('phaser')">+ PHASER</button>
    </div>
    <div class="pb-help">DRAG <span class="dot out"></span> TO CONNECT Â· CLICK WIRE TO REMOVE Â· DRAG NODE TO MOVE</div>
    <div id="pbMacroPanel">
      <div class="pb-macro-head">
        <span>MACROS</span>
        <div class="pb-macro-scenes">
          <button id="pbMacroSceneA" onclick="pbSelectMacroScene('A')">A</button>
          <button id="pbMacroSceneB" onclick="pbSelectMacroScene('B')">B</button>
          <button id="pbMacroSceneC" onclick="pbSelectMacroScene('C')">C</button>
          <button id="pbMacroSceneD" onclick="pbSelectMacroScene('D')">D</button>
        </div>
      </div>
      <div class="pb-macro-grid">
        <label>M1 TONE <input id="pbMacro1" type="range" min="0" max="100" value="45"></label>
        <label>M2 SPACE <input id="pbMacro2" type="range" min="0" max="100" value="35"></label>
        <label>M3 GLUE <input id="pbMacro3" type="range" min="0" max="100" value="55"></label>
        <label>M4 PUMP <input id="pbMacro4" type="range" min="0" max="100" value="40"></label>
      </div>
      <div class="pb-macro-actions">
        <button onclick="pbSaveMacroScene()">Guardar escena</button>
        <button onclick="pbLoadMacroScene()">Cargar escena</button>
      </div>
    </div>
  </div>

  <!-- Canvas area -->
  <div id="pbCanvas">
    <div id="pbViewControls">
      <button onclick="pbZoomOut()" title="Zoom -">âˆ’</button>
      <span id="pbZoomValue">100%</span>
      <button onclick="pbZoomIn()" title="Zoom +">+</button>
      <button onclick="pbZoomReset()" title="Reset zoom">1:1</button>
      <button id="pbGridToggleBtn" onclick="pbToggleGrid()" title="Mostrar/Ocultar cuadrÃ­cula">GRID</button>
    </div>
    <div id="pbWorld">
      <svg id="pbSVG">
        <defs>
          <filter id="cableGlow">
            <feGaussianBlur stdDeviation="3" result="blur"/>
            <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
          <filter id="nodeGlow">
            <feGaussianBlur stdDeviation="6" result="blur"/>
            <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
        </defs>
      </svg>
      <div id="pbNodes"></div>
    </div>
  </div>

  <!-- Parameter Editor Popup -->
  <div id="pbParamEditor" class="hidden">
    <div class="pb-param-header">
      <span id="pbParamTitle">EFFECT</span>
      <button onclick="closeParamEditor()">âœ•</button>
    </div>
    <div id="pbParamBody"></div>
  </div>

  <div id="pbPresetPanel" class="hidden">
    <div class="pb-preset-head">
      <span>PRESETS PATCHBAY</span>
      <button onclick="pbClosePresetPanel()">âœ•</button>
    </div>
    <div class="pb-preset-save">
      <input id="pbPresetNameInput" type="text" placeholder="Nombre preset usuario..." maxlength="48">
      <button onclick="pbSavePresetFromPanel()">Guardar</button>
    </div>
    <div class="pb-preset-sections">
      <section>
        <h3>FÃ¡brica</h3>
        <div id="pbFactoryPresetList" class="pb-preset-list"></div>
      </section>
      <section>
        <h3>Usuario</h3>
        <div id="pbUserPresetList" class="pb-preset-list"></div>
      </section>
    </div>
  </div>

  <!-- Footer -->
  <footer id="pbFooter">
    <span class="pb-status-dot" id="pbWsStatus"></span>
    <span>NODES: <b id="pbNodeCount">0</b></span>
    <span>â€”</span>
    <span>CABLES: <b id="pbCableCount">0</b></span>
    <span class="pb-footer-brand">RED808 / PATCHBAY v1.0</span>
  </footer>
</div>
<script src="patchbay.js"></script>
</body>
</html>
